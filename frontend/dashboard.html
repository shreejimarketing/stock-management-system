<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <link rel="stylesheet" href="dashboard.css" />
    <link rel="stylesheet" href="navbar.css" />
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="home.html">Edit</a></li>
        <li><a href="index.html" id="logout">Logout</a></li>
      </ul>
    </nav>
    <div id="navbar-placeholder"></div>
    <h1>Welcome to the Dashboard</h1>
    <!-- Your dashboard content goes here -->
    <section>
      <h2>Champion Max</h2>
      <table class="full-width-table" border="1">
        <thead>
          <tr>
            <th></th>
            <th colspan="6">Thickness</th>
          </tr>
          <tr>
            <th>Size</th>
            <th>6mm</th>
            <th>8mm</th>
            <th>12mm</th>
            <th>18mm</th>
            <th>19mm B.B.</th>
            <th>25mm B.B.</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>8x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section>
      <h2>High Spirit</h2>
      <table class="full-width-table" border="1">
        <thead>
          <tr>
            <th></th>
            <th colspan="6">Thickness</th>
          </tr>
          <tr>
            <th>Size</th>
            <th>6mm</th>
            <th>8mm</th>
            <th>12mm</th>
            <th>18mm</th>
            <th>19mm B.B.</th>
            <th>25mm B.B.</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>8x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section>
      <h2>Benz Club</h2>
      <table class="full-width-table" border="1">
        <thead>
          <tr>
            <th></th>
            <th colspan="6">Thickness</th>
          </tr>
          <tr>
            <th>Size</th>
            <th>6mm</th>
            <th>8mm</th>
            <th>12mm</th>
            <th>18mm</th>
            <th>19mm B.B.</th>
            <th>25mm B.B.</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>8x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section>
      <h2>Centurian</h2>
      <table class="full-width-table" border="1">
        <thead>
          <tr>
            <th></th>
            <th colspan="6">Thickness</th>
          </tr>
          <tr>
            <th>Size</th>
            <th>6mm</th>
            <th>8mm</th>
            <th>12mm</th>
            <th>18mm</th>
            <th>19mm B.B.</th>
            <th>25mm B.B.</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>8x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x4</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>7x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th>6x3</th>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </section>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tables = document.querySelectorAll("table.full-width-table");

        // Fetch product data from the server for each brand
        const brands = [
          "Champion Max",
          "High Spirit",
          "Benz Club",
          "Centurian",
        ];
        brands.forEach((brand) => {
          fetch(`/products?brand=${brand}`, {
            headers: {
              Authorization: `Bearer ${localStorage.getItem("token")}`,
            },
          })
            .then((response) => response.json())
            .then((result) => {
              if (result.success) {
                const products = result.products;
                tables.forEach((table) => {
                  const sectionBrand = table
                    .closest("section")
                    .querySelector("h2")
                    .textContent.trim();
                  if (sectionBrand === brand) {
                    const name = table
                      .closest("section")
                      .querySelector("h2")
                      .textContent.trim();
                    populateTable(table, products, name);
                  }
                });
              } else {
                alert(result.message);
              }
            })
            .catch((error) => {
              console.error("Error fetching products:", error);
              alert("An error occurred while fetching products.");
            });
        });

        function populateTable(table, products, name) {
          const tbody = table.querySelector("tbody");
          const rows = tbody.querySelectorAll("tr");

          rows.forEach((row) => {
            const size = row.querySelector("th").textContent.trim();
            const cells = row.querySelectorAll("td");

            cells.forEach((cell, index) => {
              const thickness = table
                .querySelector(
                  `thead tr:nth-of-type(2) th:nth-of-type(${index + 2})`
                )
                .textContent.trim();
              const product = products.find(
                (p) =>
                  p.name === name &&
                  p.size === size &&
                  p.thickness === thickness
              );

              // If product found, populate quantity; otherwise, set it to 0
              cell.textContent = product ? product.quantity : 0;
            });
          });
        }
      });
    </script>
    <script src="script.js"></script>
    <script src="dashboard.js"></script>
  </body>
</html>
